## Đây là Docs tự research:

## Cách dùng useQuery cơ bản trong React Query:

1. Bước đầu tiên là cài đặt React Query trong dự án của bạn. Bạn có thể sử dụng npm hoặc yarn để cài đặt:

```jsx
npm install react-query
```

hoặc

```jsx
yarn add react-query
```

2. Import `useQuery` từ thư viện React Query vào thành phần React của bạn:

```jsx
import { useQuery } from 'react-query'
```

3. Sử dụng `useQuery` trong thành phần React của bạn. Đặt tên biến và truyền vào hai đối số: `queryKey` và `queryFn`.

```jsx
const ExampleComponent = () => {
  const { data, isLoading, error } = useQuery(queryKey, queryFn);

  // Xử lý dữ liệu, hiển thị thông báo lỗi hoặc trạng thái loading

  return (
    // JSX của thành phần
  );
};
```

4. Điều chỉnh `queryKey` và `queryFn` theo nhu cầu của bạn.

- `queryKey`: Đây là một giá trị duy nhất đại diện cho truy vấn. Nó có thể là một chuỗi, mảng hoặc một đối tượng. Ví dụ: `'todos'`, `['todos', { userId: 1 }]`, `{ query: 'todos', userId: 1 }`.

- `queryFn`: Đây là một hàm không đồng bộ được sử dụng để thực hiện truy vấn dữ liệu. Hàm này trả về một Promise chứa dữ liệu bạn muốn truy vấn.

Ví dụ:

```jsx
const queryFn = async () => {
  const response = await fetch('https://api.example.com/todos')
  const data = await response.json()
  return data
}
```

5. Sử dụng `data`, `isLoading` và `error` để xử lý dữ liệu và trạng thái của truy vấn trong thành phần React của bạn.

- `data`: Chứa dữ liệu trả về từ truy vấn. Bạn có thể sử dụng nó để hiển thị thông tin trong thành phần của bạn.
- `isLoading`: Một biến boolean cho biết liệu truy vấn đang trong quá trình tải dữ liệu hay không.
- `error`: Chứa thông báo lỗi nếu truy vấn gặp phải lỗi.

6. Trong JSX của thành phần React, bạn có thể sử dụng `isLoading` để hiển thị một trạng thái loading hoặc sử dụng `data` để hiển thị dữ liệu trả về. Xử lý `error` để hiển thị thông báo lỗi nếu cần thiết.

- Đây là một ví dụ đơn giản về cách sử dụng cơ bản của `useQuery` trong React Query. Bạn có thể tùy chỉnh `queryKey` và `queryFn` theo yêu cầu cụ thể của dự án của bạn.

## Ưu điểm tuyệt vời khi so sánh React Query với cách fetch data thông qua useEffect:

- So sánh React Query với cách fetch data thông qua `useEffect`, có một số ưu điểm tuyệt vời mà React Query mang lại:

1. `Caching (Bộ nhớ cache)`: React Query tự động lưu trữ kết quả truy vấn và cung cấp chúng từ bộ nhớ cache khi cần thiết. Khi cùng một truy vấn được gọi lại, React Query sẽ trả về dữ liệu từ cache mà không cần thực hiện lại truy vấn mạng. Điều này giúp tiết kiệm thời gian và tài nguyên mạng.

2. `Invalidation (Hủy bỏ cache)`: React Query cung cấp các phương pháp để hủy bỏ và cập nhật cache khi có sự thay đổi dữ liệu. Khi dữ liệu bị thay đổi, bạn có thể thông báo cho React Query để làm mới cache và cập nhật dữ liệu mới nhất.

3. `Auto-Refetching (Tự động fetch lại)`: React Query cho phép tự động fetch lại dữ liệu sau một khoảng thời gian nhất định hoặc khi có sự kiện xảy ra. Bạn có thể định cấu hình cho truy vấn tự động cập nhật để đảm bảo dữ liệu luôn được đồng bộ và cập nhật mới nhất.

4. `Optimistic Updates (Cập nhật lạc quan)`: React Query cho phép cập nhật giao diện ngay lập tức và sau đó làm việc với dữ liệu bất đồng bộ. Bạn có thể cập nhật giao diện trước khi truy vấn hoàn thành, mang lại trải nghiệm người dùng mượt mà hơn.

5. `Error Handling (Xử lý lỗi)`: React Query hỗ trợ xử lý lỗi một cách linh hoạt và cung cấp các phương pháp để hiển thị thông báo lỗi cho người dùng. Bạn có thể kiểm soát cách xử lý lỗi và hiển thị thông báo tùy chỉnh cho các trường hợp lỗi khác nhau.

- Tổng thể, React Query giúp đơn giản hóa việc quản lý trạng thái dữ liệu bất đồng bộ, cache và xử lý lỗi trong ứng dụng React. Nó cung cấp một cách tiếp cận mạnh mẽ và linh hoạt để làm việc với dữ liệu, giúp tăng hiệu suất và trải nghiệm người dùng của ứng dụng của bạn.

## Cách dùng queryKey và queryFn:

- Cả hai `queryKey` và `queryFn` đều là các đối số trong hook `useQuery` của React Query và được sử dụng để xác định truy vấn dữ liệu cụ thể.

1. queryKey:

- `queryKey` là một giá trị duy nhất đại diện cho truy vấn. Nó có thể là một chuỗi, mảng hoặc một đối tượng. `queryKey` được sử dụng để xác định dữ liệu cần truy vấn và cũng là một phần quan trọng trong việc quản lý bộ nhớ cache của React Query.

- Ví dụ với một chuỗi `queryKey`:

```jsx
const { data } = useQuery('todos', fetchTodos)
```

- Trong ví dụ này, `'todos'` là `queryKey` đại diện cho truy vấn dữ liệu danh sách công việc.

- Ví dụ với một mảng `queryKey`:

```jsx
const { data } = useQuery(['todos', { userId: 1 }], fetchUserTodos)
```

- Trong ví dụ này, `['todos', { userId: 1 }]` là `queryKey` đại diện cho truy vấn dữ liệu danh sách công việc của một người dùng cụ thể (có `userId` là 1).

- Ví dụ với một đối tượng `queryKey`:

```jsx
const { data } = useQuery({ query: 'todos', userId: 1 }, fetchUserTodos)
```

- Trong ví dụ này, `{ query: 'todos', userId: 1 }` là `queryKey` đại diện cho truy vấn dữ liệu danh sách công việc của một người dùng cụ thể (có `userId` là 1).

- Bạn có thể tùy chỉnh `queryKey` theo yêu cầu cụ thể của dự án.

2. queryFn:

- `queryFn` là một hàm không đồng bộ được sử dụng để thực hiện truy vấn dữ liệu. Hàm này trả về một `Promise` chứa dữ liệu bạn muốn truy vấn.

- Ví dụ:

```jsx
const fetchTodos = async () => {
  const response = await fetch('https://api.example.com/todos')
  const data = await response.json()
  return data
}

const { data } = useQuery('todos', fetchTodos)
```

- Trong ví dụ này, `fetchTodos` là một `queryFn` thực hiện việc gửi yêu cầu mạng để lấy dữ liệu danh sách công việc từ một API. Hàm này trả về một `Promise` chứa dữ liệu được gửi về từ API.

- Bạn có thể tạo và tùy chỉnh `queryFn` để phù hợp với nhu cầu truy vấn dữ liệu trong dự án của bạn.

## Fetch API với useEffect và Axios:

- Dưới đây là ví dụ về cách sử dụng `useEffect` và `Axios` để thực hiện Fetch API:

```jsx
import React, { useEffect, useState } from 'react'
import axios from 'axios'

const ExampleComponent = () => {
  const [data, setData] = useState(null)
  const [isLoading, setIsLoading] = useState(false)
  const [error, setError] = useState(null)

  useEffect(() => {
    const fetchData = async () => {
      setIsLoading(true)
      try {
        const response = await axios.get('https://api.example.com/data')
        setData(response.data)
        setIsLoading(false)
      } catch (error) {
        setError(error.message)
        setIsLoading(false)
      }
    }

    fetchData()
  }, [])

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (error) {
    return <div>Error: {error}</div>
  }

  return (
    <div>
      {data && (
        <ul>
          {data.map((item) => (
            <li key={item.id}>{item.name}</li>
          ))}
        </ul>
      )}
    </div>
  )
}

export default ExampleComponent
```

- Trong ví dụ này:

- Chúng ta sử dụng hook `useState` để khởi tạo các state `data`, `isLoading`, và `error`.
- Trong `useEffect`, chúng ta định nghĩa hàm `fetchData` để thực hiện truy vấn dữ liệu. Trong trường hợp này, chúng ta sử dụng `Axios` để gửi yêu cầu `GET` đến URL `'https://api.example.com/data'`. Khi yêu cầu thành công, dữ liệu được lấy từ phản hồi và được lưu vào state `data`, `isLoading` được đặt về `false`. Nếu xảy ra lỗi, lỗi được lưu vào state `error`, `isLoading` được đặt về `false`.
- Chúng ta gọi hàm `fetchData` trong `useEffect` một lần duy nhất bằng cách truyền một mảng rỗng `[]` làm tham số thứ hai. Điều này đảm bảo rằng truy vấn chỉ được thực hiện một lần khi `component` được `render` lần đầu tiên.
- Trong JSX, chúng ta hiển thị thông báo `"Loading..."` nếu `isLoading` là `true`, hiển thị thông báo lỗi nếu `error` tồn tại, và hiển thị dữ liệu từ `data` nếu tồn tại.

- Với ví dụ trên, bạn có thể tùy chỉnh URL của API và xử lý dữ liệu theo nhu cầu của dự án của bạn.

## Fetch data với useQuery và Axios:

-

## Cài dev tool cho React Query:

## Hãy giải thích chi tiết về queryKey:

## Hãy giải thích chi tiết về queryFn:

## Tóm tắt về React Query:

## Tóm tắt về gọi API với React Query:

## Đây là Docs của Được Dev:

💓Kiến thức các bạn sẽ được học trong video này:

🎉 Cách dùng useQuery cơ bản trong React Query
🎉 Ưu điểm tuyệt vời khi so sánh React Query với cách fetch data thông qua useEffect
🎉 Cách dùng queryKey và queryFn

🕰️Nội dung chính

00:00 - Giới thiệu về series
03:47 - Giới thiệu về repository
07:58 - Fetch API với useEffect và Axios
23:29 - Fetch data với useQuery và Axios
36:47 - Cài dev tool cho React Query
38:58 - queryKey
47:05 - queryFn
47:53 - Tóm tắt kiến thức đã học

![image bài 144](image.png)
