## ƒê√¢y l√† Docs t·ª± Research:

- ‚ùì ƒê√¢y l√† c√°c c√¢u h·ªèi trong video:

- L√†m sao ƒë·ªÉ `getQueriesData` n√≥ l·∫•y d·ªØ li·ªáu m·ªõi nh·∫•t nh·ªâ, th∆∞·ªùng n√≥ ch·ªâ l·∫•y l·∫ßn ƒë·∫ßu `fetchapi` ?

  - üëâ Trong React Query, khi b·∫°n g·ªçi ph∆∞∆°ng th·ª©c `getQueriesData` ƒë·ªÉ l·∫•y d·ªØ li·ªáu t·ª´ cache, n√≥ s·∫Ω tr·∫£ v·ªÅ d·ªØ li·ªáu m·ªõi nh·∫•t t·ª´ cache n·∫øu c√≥ s·∫µn. Tuy nhi√™n, n·∫øu d·ªØ li·ªáu ch∆∞a c√≥ trong cache ho·∫∑c n·∫øu cache ƒë√£ h·∫øt h·∫°n (stale), React Query s·∫Ω t·ª± ƒë·ªông th·ª±c hi·ªán m·ªôt cu·ªôc g·ªçi m·∫°ng ƒë·ªÉ l·∫•y d·ªØ li·ªáu m·ªõi nh·∫•t t·ª´ ngu·ªìn d·ªØ li·ªáu (API ch·∫≥ng h·∫°n).

  - Khi b·∫°n th·ª±c hi·ªán m·ªôt query l·∫ßn ƒë·∫ßu ti√™n b·∫±ng c√°ch s·ª≠ d·ª•ng hook `useQuery`, React Query s·∫Ω g·ª≠i m·ªôt y√™u c·∫ßu m·∫°ng ƒë·ªÉ l·∫•y d·ªØ li·ªáu t·ª´ ngu·ªìn d·ªØ li·ªáu v√† l∆∞u tr·ªØ k·∫øt qu·∫£ trong cache. Khi b·∫°n g·ªçi `getQueriesData`, n·∫øu d·ªØ li·ªáu trong cache v·∫´n c√≤n h·ª£p l·ªá (ch∆∞a h·∫øt h·∫°n), React Query s·∫Ω tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√≥ m√† kh√¥ng g·ª≠i y√™u c·∫ßu m·∫°ng. Tuy nhi√™n, n·∫øu d·ªØ li·ªáu ƒë√£ h·∫øt h·∫°n, React Query s·∫Ω t·ª± ƒë·ªông g·ªçi API ƒë·ªÉ l·∫•y d·ªØ li·ªáu m·ªõi nh·∫•t v√† c·∫≠p nh·∫≠t cache tr∆∞·ªõc khi tr·∫£ v·ªÅ k·∫øt qu·∫£ cho `getQueriesData`.

  - V√¨ v·∫≠y, khi s·ª≠ d·ª•ng `getQueriesData`, b·∫°n c√≥ th·ªÉ y√™n t√¢m r·∫±ng d·ªØ li·ªáu tr·∫£ v·ªÅ s·∫Ω l√† phi√™n b·∫£n m·ªõi nh·∫•t t·ª´ ngu·ªìn d·ªØ li·ªáu, ngay c·∫£ khi cache ƒë√£ h·∫øt h·∫°n. React Query s·∫Ω t·ª± ƒë·ªông qu·∫£n l√Ω qu√° tr√¨nh c·∫≠p nh·∫≠t d·ªØ li·ªáu v√† ƒë·∫£m b·∫£o b·∫°n nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu m·ªõi nh·∫•t khi c·∫ßn thi·∫øt.

---

- ‚ùì Ch∆∞a hi·ªÉu c√°ch th·∫±ng react query n√†y c√≥ th·ªÉ thay th·∫ø cho redux ch·ªó n√†o? Th·∫±ng n√†y d·ª±a v√†o key th√¨ qu·∫£n l√Ω key ki·ªÉu g√¨ trong project cho kh·ªèi lo·∫°n ƒë√¢y ?

  - üëâ Redux c≈©ng d·ª±a v√†o key ƒë·ªÉ ph√¢n bi·ªát `action` m√†, V·∫•n ƒë·ªÅ redux l√† n√≥ r∆∞·ªùm r√† (√Ω ki·∫øn n√†y ·ªü trong b√†i h·ªçc)

  - üëâ T·ª± Search: üëà

  - React Query kh√¥ng thay th·∫ø Redux ho√†n to√†n, nh∆∞ng n√≥ cung c·∫•p m·ªôt gi·∫£i ph√°p hi·ªáu qu·∫£ cho vi·ªác qu·∫£n l√Ω tr·∫°ng th√°i ·ª©ng d·ª•ng v√† t∆∞∆°ng t√°c v·ªõi ngu·ªìn d·ªØ li·ªáu.

  - Redux l√† m·ªôt th∆∞ vi·ªán qu·∫£n l√Ω tr·∫°ng th√°i to√†n c·ª•c (global), th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ l∆∞u tr·ªØ c√°c tr·∫°ng th√°i quan tr·ªçng v√† chia s·∫ª ch√∫ng gi·ªØa c√°c th√†nh ph·∫ßn trong ·ª©ng d·ª•ng. Redux h·ªØu √≠ch khi b·∫°n c·∫ßn qu·∫£n l√Ω tr·∫°ng th√°i ph·ª©c t·∫°p v√† c√≥ nhu c·∫ßu s·ª≠ d·ª•ng c√°c `middleware` ho·∫∑c `side effects`.

  - Trong khi ƒë√≥, React Query t·∫≠p trung v√†o qu·∫£n l√Ω d·ªØ li·ªáu li√™n quan ƒë·∫øn truy v·∫•n v√† x·ª≠ l√Ω c√°c t√°c v·ª• m·∫°ng. N√≥ gi√∫p b·∫°n th·ª±c hi·ªán c√°c truy v·∫•n d·ªØ li·ªáu, qu·∫£n l√Ω cache v√† t·ª± ƒë·ªông l√†m m·ªõi d·ªØ li·ªáu theo th·ªùi gian th·ª±c. React Query t·∫°o ra m·ªôt l·ªõp tr·ª´u t∆∞·ª£ng ƒë·ªÉ x·ª≠ l√Ω c√°c ho·∫°t ƒë·ªông li√™n quan ƒë·∫øn d·ªØ li·ªáu, gi√∫p gi·∫£m b·ªõt s·ª± ph·ª©c t·∫°p c·ªßa vi·ªác qu·∫£n l√Ω tr·∫°ng th√°i v√† t∆∞∆°ng t√°c v·ªõi d·ªØ li·ªáu t·ª´ ngu·ªìn.

  - React Query c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng k·∫øt h·ª£p v·ªõi Redux trong m·ªôt ·ª©ng d·ª•ng. B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng Redux ƒë·ªÉ qu·∫£n l√Ω c√°c tr·∫°ng th√°i to√†n c·ª•c v√† React Query ƒë·ªÉ qu·∫£n l√Ω c√°c truy v·∫•n v√† cache d·ªØ li·ªáu. ƒêi·ªÅu n√†y gi√∫p b·∫°n t·∫≠n d·ª•ng ƒë∆∞·ª£c l·ª£i √≠ch c·ªßa c·∫£ hai th∆∞ vi·ªán v√† tu·ª≥ ch·ªânh theo nhu c·∫ßu c·ª• th·ªÉ c·ªßa d·ª± √°n.

  - V·ªÅ vi·ªác qu·∫£n l√Ω key trong React Query, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng b·∫•t k·ª≥ lo·∫°i key n√†o ph√π h·ª£p v·ªõi d·ª± √°n c·ªßa m√¨nh. Key th∆∞·ªùng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a d∆∞·ªõi d·∫°ng m·ªôt m·∫£ng (`array`) ho·∫∑c m·ªôt chu·ªói (`string`) ƒë·∫°i di·ªán cho truy v·∫•n c·ª• th·ªÉ. B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c gi√° tr·ªã duy nh·∫•t nh∆∞ `ID` ng∆∞·ªùi d√πng, t√™n truy v·∫•n, ho·∫∑c b·∫•t k·ª≥ gi√° tr·ªã n√†o m√† b·∫°n cho l√† ph√π h·ª£p ƒë·ªÉ ƒë·ªãnh danh truy v·∫•n. ƒêi·ªÅu n√†y gi√∫p React Query x√°c ƒë·ªãnh v√† qu·∫£n l√Ω c√°c truy v·∫•n ri√™ng bi·ªát m·ªôt c√°ch ch√≠nh x√°c.

---

- ## ‚ùì‚ùì‚ùì C√°c c√¢u h·ªèi th·∫Øc m·∫Øc (t·ª± research):

## T·ªïng k·∫øt l·∫°i ch∆∞∆°ng React Query ?

- React Query l√† m·ªôt th∆∞ vi·ªán qu·∫£n l√Ω tr·∫°ng th√°i v√† cache d·ªØ li·ªáu trong ·ª©ng d·ª•ng React. N√≥ cung c·∫•p c√°c kh√°i ni·ªám v√† API cho ph√©p t∆∞∆°ng t√°c d·ªÖ d√†ng v·ªõi d·ªØ li·ªáu t·ª´ c√°c ngu·ªìn kh√°c nhau nh∆∞ API, localStorage, hay b·∫•t k·ª≥ ngu·ªìn d·ªØ li·ªáu n√†o kh√°c.

- D∆∞·ªõi ƒë√¢y l√† nh·ªØng kh√°i ni·ªám ch√≠nh v√† t√≠nh nƒÉng quan tr·ªçng c·ªßa React Query:

1. `Query`: M·ªôt query ƒë·∫°i di·ªán cho m·ªôt truy v·∫•n d·ªØ li·ªáu t·ª´ m·ªôt ngu·ªìn nh·∫•t ƒë·ªãnh. React Query cung c·∫•p hook `useQuery` ƒë·ªÉ th·ª±c hi·ªán c√°c truy v·∫•n n√†y.

2. `Mutations`: Mutations ƒë·∫°i di·ªán cho c√°c ho·∫°t ƒë·ªông thay ƒë·ªïi d·ªØ li·ªáu nh∆∞ t·∫°o, c·∫≠p nh·∫≠t ho·∫∑c x√≥a. React Query cung c·∫•p hook `useMutation` ƒë·ªÉ th·ª±c hi·ªán c√°c mutations.

3. `Query Invalidation`: React Query h·ªó tr·ª£ vi·ªác l√†m m·ªõi (refresh) d·ªØ li·ªáu th√¥ng qua ph∆∞∆°ng th·ª©c `invalidateQueries`, cho ph√©p ch√∫ng ta x√≥a cache c·ªßa m·ªôt ho·∫∑c nhi·ªÅu queries.

4. `Automatic Caching`: React Query t·ª± ƒë·ªông l∆∞u tr·ªØ d·ªØ li·ªáu truy v·∫•n v√† qu·∫£n l√Ω vi·ªác c·∫≠p nh·∫≠t d·ªØ li·ªáu khi c√≥ s·ª± thay ƒë·ªïi. N√≥ s·ª≠ d·ª•ng c∆° ch·∫ø cache th√¥ng minh ƒë·ªÉ t·∫≠n d·ª•ng l·∫°i d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c truy v·∫•n tr∆∞·ªõc ƒë√≥ m√† kh√¥ng c·∫ßn g·ª≠i y√™u c·∫ßu m·∫°ng.

5. `Prefetching`: React Query cung c·∫•p t√≠nh nƒÉng prefetching, cho ph√©p ch√∫ng ta t·∫£i tr∆∞·ªõc d·ªØ li·ªáu trong background tr∆∞·ªõc khi n√≥ ƒë∆∞·ª£c y√™u c·∫ßu, t·ªëi ∆∞u h√≥a tr·∫£i nghi·ªám ng∆∞·ªùi d√πng.

6. `Optimistic Updates`: T√≠nh nƒÉng optimistic updates cho ph√©p ch√∫ng ta c·∫≠p nh·∫≠t giao di·ªán ngay l·∫≠p t·ª©c m√† kh√¥ng c·∫ßn ch·ªù ƒë·ª£i ph·∫£n h·ªìi t·ª´ server khi th·ª±c hi·ªán mutations.

- React Query gi√∫p tƒÉng hi·ªáu su·∫•t ·ª©ng d·ª•ng, gi·∫£m s·ªë l·∫ßn g·ªçi m·∫°ng kh√¥ng c·∫ßn thi·∫øt, cung c·∫•p kh·∫£ nƒÉng x·ª≠ l√Ω l·ªói v√† cung c·∫•p m·ªôt c√°ch ti·∫øp c·∫≠n d·ªÖ d√πng v√† linh ho·∫°t trong qu·∫£n l√Ω d·ªØ li·ªáu.

---

## Nh·ªØng ki·∫øn th·ª©c nh·∫≠n ƒë∆∞·ª£c khi h·ªçc xong kho√° React Query ?

- Khi ho√†n th√†nh vi·ªác h·ªçc kho√° React Query, b·∫°n s·∫Ω c√≥ ki·∫øn th·ª©c v·ªÅ c√°c kh√°i ni·ªám v√† k·ªπ thu·∫≠t ch√≠nh sau:

1. `C∆° b·∫£n v·ªÅ React Query`: B·∫°n s·∫Ω hi·ªÉu ƒë∆∞·ª£c React Query l√† g√¨, t·∫°i sao n√≥ h·ªØu √≠ch trong qu·∫£n l√Ω tr·∫°ng th√°i v√† t∆∞∆°ng t√°c d·ªØ li·ªáu trong ·ª©ng d·ª•ng React.

2. `C√°ch s·ª≠ d·ª•ng useQuery hook`: B·∫°n s·∫Ω bi·∫øt c√°ch s·ª≠ d·ª•ng `useQuery` hook ƒë·ªÉ th·ª±c hi·ªán c√°c truy v·∫•n d·ªØ li·ªáu, qu·∫£n l√Ω cache v√† x·ª≠ l√Ω c√°c tr·∫°ng th√°i kh√°c nhau (nh∆∞ loading, error) c·ªßa truy v·∫•n.

3. `Qu·∫£n l√Ω cache d·ªØ li·ªáu`: B·∫°n s·∫Ω hi·ªÉu c√°ch React Query qu·∫£n l√Ω cache d·ªØ li·ªáu v√† t·ª± ƒë·ªông l√†m m·ªõi d·ªØ li·ªáu theo th·ªùi gian th·ª±c.

4. `T√≠ch h·ª£p v·ªõi mutation`: B·∫°n s·∫Ω bi·∫øt c√°ch s·ª≠ d·ª•ng mutation ƒë·ªÉ th·ª±c hi·ªán c√°c thao t√°c c·∫≠p nh·∫≠t d·ªØ li·ªáu th√™m, s·ª≠a, x√≥a (POST, PUT, DELETE) v√† l√†m m·ªõi cache. L∆∞u √Ω ch·ªâ c√≥ l·∫•y d·ªØ li·ªáu (GET) l√† s·ª≠ d·ª•ng query .

5. `Qu·∫£n l√Ω dependencies`: B·∫°n s·∫Ω hi·ªÉu c√°ch x√°c ƒë·ªãnh v√† qu·∫£n l√Ω c√°c ph·ª• thu·ªôc gi·ªØa c√°c truy v·∫•n, cho ph√©p l√†m m·ªõi t·ª± ƒë·ªông c√°c truy v·∫•n li√™n quan khi c√≥ thay ƒë·ªïi.

6. `T√≠ch h·ª£p v·ªõi prefetching`: B·∫°n s·∫Ω bi·∫øt c√°ch s·ª≠ d·ª•ng t√≠nh nƒÉng prefetching ƒë·ªÉ t·∫£i d·ªØ li·ªáu tr∆∞·ªõc v√† cung c·∫•p tr·∫£i nghi·ªám nhanh h∆°n cho ng∆∞·ªùi d√πng.

7. `T∆∞∆°ng t√°c v·ªõi cache tr·ª±c ti·∫øp`: B·∫°n s·∫Ω hi·ªÉu c√°ch truy c·∫≠p v√† c·∫≠p nh·∫≠t cache tr·ª±c ti·∫øp th√¥ng qua `useQueryClient` hook.

8. `X·ª≠ l√Ω l·ªói v√† th√¥ng b√°o`: B·∫°n s·∫Ω bi·∫øt c√°ch x·ª≠ l√Ω l·ªói trong React Query v√† hi·ªÉn th·ªã th√¥ng b√°o cho ng∆∞·ªùi d√πng khi c√≥ l·ªói x·∫£y ra.

9. `C·∫•u h√¨nh v√† t√πy ch·ªânh`: B·∫°n s·∫Ω hi·ªÉu c√°ch c·∫•u h√¨nh (config) v√† t√πy ch·ªânh (custom) React Query theo nhu c·∫ßu d·ª± √°n, bao g·ªìm th·ªùi gian stale, s·ªë l·∫ßn t√°i th·ª≠, ƒë·ªô ∆∞u ti√™n v√† c√°c t√πy ch·ªçn kh√°c.

10. `Qu·∫£n l√Ω tr·∫°ng th√°i ·ª©ng d·ª•ng`: B·∫°n s·∫Ω bi·∫øt c√°ch s·ª≠ d·ª•ng React Query ƒë·ªÉ qu·∫£n l√Ω tr·∫°ng th√°i ·ª©ng d·ª•ng v√† l√†m vi·ªác v·ªõi c√°c truy v·∫•n d·ªØ li·ªáu trong to√†n b·ªô ·ª©ng d·ª•ng.

- V·ªõi nh·ªØng ki·∫øn th·ª©c n√†y, b·∫°n s·∫Ω c√≥ kh·∫£ nƒÉng s·ª≠ d·ª•ng React Query ƒë·ªÉ x√¢y d·ª±ng c√°c ·ª©ng d·ª•ng React hi·ªáu qu·∫£, qu·∫£n l√Ω tr·∫°ng th√°i v√† t∆∞∆°ng t√°c d·ªØ li·ªáu m·ªôt c√°ch linh ho·∫°t v√† d·ªÖ d√†ng.

---

## ƒêi·ªÉm m·∫°nh v√† ƒëi·ªÉm y·∫øu c·ªßa React Query ?

- React Query c√≥ m·ªôt s·ªë ƒëi·ªÉm m·∫°nh v√† ƒëi·ªÉm y·∫øu sau ƒë√¢y:

- ‚úÖ ƒêi·ªÉm m·∫°nh:

  - ƒê∆°n gi·∫£n v√† d·ªÖ s·ª≠ d·ª•ng: React Query cung c·∫•p c√∫ ph√°p d·ªÖ hi·ªÉu v√† g·ªçn nh·∫π, gi√∫p vi·ªác qu·∫£n l√Ω d·ªØ li·ªáu v√† th·ª±c hi·ªán c√°c truy v·∫•n API tr·ªü n√™n ƒë∆°n gi·∫£n v√† d·ªÖ d√†ng.

  - Qu·∫£n l√Ω b·ªô nh·ªõ cache m·∫°nh m·∫Ω: React Query t·ª± ƒë·ªông qu·∫£n l√Ω b·ªô nh·ªõ cache cho d·ªØ li·ªáu truy v·∫•n, gi√∫p tƒÉng hi·ªáu su·∫•t v√† gi·∫£m s·ªë l∆∞·ª£ng cu·ªôc g·ªçi API kh√¥ng c·∫ßn thi·∫øt. C√°c truy v·∫•n ƒë∆∞·ª£c l∆∞u tr·ªØ trong b·ªô nh·ªõ cache v√† c√≥ th·ªÉ ƒë∆∞·ª£c t√°i s·ª≠ d·ª•ng khi c·∫ßn thi·∫øt.

  - H·ªó tr·ª£ cho t·∫•t c·∫£ c√°c lo·∫°i truy v·∫•n: React Query h·ªó tr·ª£ c√°c lo·∫°i truy v·∫•n phong ph√∫ nh∆∞ GET, POST, PUT, DELETE v√† cung c·∫•p c√°c ph∆∞∆°ng th·ª©c v√† t√≠nh nƒÉng linh ho·∫°t ƒë·ªÉ th·ª±c hi·ªán c√°c ho·∫°t ƒë·ªông truy v·∫•n ph·ª©c t·∫°p.

  - Cung c·∫•p c√°c t√≠nh nƒÉng ti√™n ti·∫øn: React Query cung c·∫•p c√°c t√≠nh nƒÉng m·∫°nh m·∫Ω nh∆∞ `prefetching`, `pagination`, `realtime` `updates`, v√† `optimistic updates`, gi√∫p c·∫£i thi·ªán tr·∫£i nghi·ªám ng∆∞·ªùi d√πng v√† tƒÉng kh·∫£ nƒÉng t∆∞∆°ng t√°c c·ªßa ·ª©ng d·ª•ng.

- ‚ùå ƒêi·ªÉm y·∫øu:

  - H·ªçc c√∫ ph√°p ban ƒë·∫ßu: React Query c√≥ m·ªôt s·ªë kh√°i ni·ªám m·ªõi v√† ph·∫£i h·ªçc c√∫ ph√°p v√† c√°c API c·ªßa n√≥. ƒêi·ªÅu n√†y c√≥ th·ªÉ ƒë√≤i h·ªèi m·ªôt th·ªùi gian ƒë·ªÉ l√†m quen v√† hi·ªÉu r√µ c√°ch th·ª©c ho·∫°t ƒë·ªông c·ªßa n√≥.

  - Ph·ª• thu·ªôc v√†o k·ªπ nƒÉng JavaScript: React Query l√† m·ªôt th∆∞ vi·ªán JavaScript v√† y√™u c·∫ßu b·∫°n c√≥ ki·∫øn th·ª©c v·ªÅ JavaScript ƒë·ªÉ s·ª≠ d·ª•ng hi·ªáu qu·∫£. N·∫øu b·∫°n kh√¥ng quen v·ªõi JavaScript, c√≥ th·ªÉ m·∫•t th·ªùi gian ƒë·ªÉ l√†m quen v√† th√≠ch nghi v·ªõi React Query.

  - T√≠ch h·ª£p v·ªõi c√°c c√¥ng ngh·ªá kh√°c: M·∫∑c d√π React Query cung c·∫•p c√°c t√≠nh nƒÉng v√† API m·∫°nh m·∫Ω, nh∆∞ng c√≥ th·ªÉ c·∫ßn t√≠ch h·ª£p v·ªõi c√°c c√¥ng ngh·ªá kh√°c nh∆∞ Redux, React Router ho·∫∑c c√°c th∆∞ vi·ªán qu·∫£n l√Ω tr·∫°ng th√°i kh√°c. Vi·ªác t√≠ch h·ª£p n√†y c√≥ th·ªÉ ƒë√≤i h·ªèi ki·∫øn th·ª©c b·ªï sung v√† s·ª± ƒë·ªìng b·ªô gi·ªØa c√°c c√¥ng ngh·ªá kh√°c nhau.

  - T√≥m l·∫°i, React Query l√† m·ªôt th∆∞ vi·ªán m·∫°nh m·∫Ω v√† ti·ªán √≠ch ƒë·ªÉ qu·∫£n l√Ω d·ªØ li·ªáu v√† truy v·∫•n API trong ·ª©ng d·ª•ng React. M·∫∑c d√π c√≥ m·ªôt s·ªë ƒëi·ªÉm y·∫øu, nh∆∞ng v·ªõi nh·ªØng ƒëi·ªÉm m·∫°nh c·ªßa n√≥, n√≥ ƒë√£ tr·ªü th√†nh m·ªôt c√¥ng c·ª• ph·ªï bi·∫øn cho vi·ªác ph√°t tri·ªÉn ·ª©ng d·ª•ng React chuy√™n nghi·ªáp.

---

## Cho c√°c v√≠ d·ª• v·ªÅ React Query c∆° b·∫£n ?

- D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë v√≠ d·ª• c∆° b·∫£n v·ªÅ vi·ªác s·ª≠ d·ª•ng React Query:

## 1. S·ª≠ d·ª•ng `useQuery` ƒë·ªÉ truy v·∫•n d·ªØ li·ªáu t·ª´ API:

```jsx
import { useQuery } from 'react-query'

function UserProfile({ userId }) {
  const { data, isLoading, error } = useQuery('userData', () => fetch(`/api/users/${userId}`).then((res) => res.json()))

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (error) {
    return <div>Error: {error.message}</div>
  }

  return (
    <div>
      <h2>User Profile</h2>
      <p>Name: {data.name}</p>
      <p>Email: {data.email}</p>
    </div>
  )
}
```

‚ùì Gi·∫£i th√≠ch code chi ti·∫øt:

- ƒêo·∫°n code tr√™n l√† m·ªôt v√≠ d·ª• c∆° b·∫£n v·ªÅ vi·ªác s·ª≠ d·ª•ng React Query ƒë·ªÉ truy v·∫•n d·ªØ li·ªáu t·ª´ m·ªôt API. D∆∞·ªõi ƒë√¢y l√† c√°ch ho·∫°t ƒë·ªông c·ªßa code:

1. S·ª≠ d·ª•ng hook `useQuery` t·ª´ React Query ƒë·ªÉ t·∫°o m·ªôt truy v·∫•n. Truy·ªÅn v√†o `userData` l√† key ƒë·ªÉ x√°c ƒë·ªãnh truy v·∫•n n√†y.

2. Trong h√†m callback c·ªßa `useQuery`, ch√∫ng ta g·ªçi `fetch` API ƒë·ªÉ l·∫•y d·ªØ li·ªáu ng∆∞·ªùi d√πng t·ª´ `/api/users/${userId}`. K·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ API ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng ph∆∞∆°ng th·ª©c `res.json()`.

3. K·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ `useQuery` bao g·ªìm `data`, `isLoading` v√† `error`.

- `data`: D·ªØ li·ªáu c·ªßa truy v·∫•n, trong tr∆∞·ªùng h·ª£p n√†y l√† th√¥ng tin ng∆∞·ªùi d√πng nh∆∞ name v√† email.
- `isLoading`: Tr·∫°ng th√°i ƒëang t·∫£i d·ªØ li·ªáu (`isLoading` l√† `true`). N·∫øu ƒëang t·∫£i, hi·ªÉn th·ªã th√¥ng b√°o `"Loading..."`.
- `error`: L·ªói x·∫£y ra trong qu√° tr√¨nh truy v·∫•n. N·∫øu c√≥ l·ªói, hi·ªÉn th·ªã th√¥ng b√°o l·ªói.

4. D·ª±a v√†o tr·∫°ng th√°i `isLoading` v√† `error`, ch√∫ng ta hi·ªÉn th·ªã giao di·ªán t∆∞∆°ng ·ª©ng. N·∫øu ƒëang t·∫£i, hi·ªÉn th·ªã th√¥ng b√°o `"Loading..."`. N·∫øu c√≥ l·ªói, hi·ªÉn th·ªã th√¥ng b√°o l·ªói. N·∫øu kh√¥ng c√≥ l·ªói v√† d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l·∫•y th√†nh c√¥ng, hi·ªÉn th·ªã th√¥ng tin ng∆∞·ªùi d√πng bao g·ªìm name v√† email.

- V·ªõi React Query, ch√∫ng ta c√≥ th·ªÉ d·ªÖ d√†ng th·ª±c hi·ªán vi·ªác truy v·∫•n d·ªØ li·ªáu t·ª´ API v√† qu·∫£n l√Ω tr·∫°ng th√°i c·ªßa truy v·∫•n. React Query t·ª± ƒë·ªông qu·∫£n l√Ω vi·ªác caching, l√†m m·ªõi d·ªØ li·ªáu v√† x·ª≠ l√Ω c√°c tr·∫°ng th√°i li√™n quan ƒë·∫øn truy v·∫•n. ƒêi·ªÅu n√†y gi√∫p ti·∫øt ki·ªám c√¥ng s·ª©c v√† gi·∫£m b·ªõt vi·ªác l·∫∑p l·∫°i code x·ª≠ l√Ω truy v·∫•n d·ªØ li·ªáu trong React components.

## 2. S·ª≠ d·ª•ng `useMutation` ƒë·ªÉ th·ª±c hi·ªán c√°c thao t√°c t·∫°o, c·∫≠p nh·∫≠t ho·∫∑c x√≥a d·ªØ li·ªáu:

```jsx
import { useMutation } from 'react-query'

function CreateUserForm() {
  const createUser = useMutation((formData) =>
    fetch('/api/users', {
      method: 'POST',
      body: JSON.stringify(formData)
    }).then((res) => res.json())
  )

  const handleSubmit = (e) => {
    e.preventDefault()
    const formData = new FormData(e.target)
    createUser.mutate(Object.fromEntries(formData))
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type='text' name='name' placeholder='Name' required />
      <input type='email' name='email' placeholder='Email' required />
      <button type='submit' disabled={createUser.isLoading}>
        {createUser.isLoading ? 'Creating...' : 'Create User'}
      </button>
    </form>
  )
}
```

‚ùì Gi·∫£i th√≠ch code chi ti·∫øt:

- ƒêo·∫°n code tr√™n l√† m·ªôt v√≠ d·ª• v·ªÅ vi·ªác s·ª≠ d·ª•ng `useMutation` t·ª´ React Query ƒë·ªÉ th·ª±c hi·ªán m·ªôt mutation, c·ª• th·ªÉ l√† t·∫°o m·ªõi ng∆∞·ªùi d√πng th√¥ng qua API.

- D∆∞·ªõi ƒë√¢y l√† c√°ch ho·∫°t ƒë·ªông c·ªßa code:

1. S·ª≠ d·ª•ng hook `useMutation` t·ª´ React Query ƒë·ªÉ t·∫°o m·ªôt mutation. Truy·ªÅn v√†o m·ªôt h√†m callback, trong ƒë√≥ ch√∫ng ta s·ª≠ d·ª•ng `fetch` API ƒë·ªÉ g·ª≠i m·ªôt y√™u c·∫ßu POST ƒë·∫øn `/api/users` v·ªõi d·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y t·ª´ `formData`. K·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ API ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng ph∆∞∆°ng th·ª©c `res.json()`.

2. `useMutation` tr·∫£ v·ªÅ m·ªôt ƒë·ªëi t∆∞·ª£ng c√≥ c√°c thu·ªôc t√≠nh v√† ph∆∞∆°ng th·ª©c li√™n quan ƒë·∫øn mutation:

- `mutate`: M·ªôt ph∆∞∆°ng th·ª©c ƒë·ªÉ th·ª±c hi·ªán mutation. Trong tr∆∞·ªùng h·ª£p n√†y, ch√∫ng ta g·ªçi `createUser.mutate` ƒë·ªÉ g·ª≠i y√™u c·∫ßu t·∫°o ng∆∞·ªùi d√πng v·ªõi d·ªØ li·ªáu t·ª´ `formData`.
- `isLoading`: Tr·∫°ng th√°i ƒëang t·∫£i. Ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng `createUser.isLoading` ƒë·ªÉ ki·ªÉm tra xem mutation ƒëang ti·∫øn h√†nh hay kh√¥ng.

3. Trong h√†m `handleSubmit`, ch√∫ng ta x·ª≠ l√Ω s·ª± ki·ªán submit c·ªßa form. Ch√∫ng ta ngƒÉn ch·∫∑n h√†nh vi m·∫∑c ƒë·ªãnh c·ªßa form b·∫±ng c√°ch g·ªçi `e.preventDefault()`. Sau ƒë√≥, ch√∫ng ta t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng `formData` t·ª´ c√°c tr∆∞·ªùng d·ªØ li·ªáu trong form s·ª≠ d·ª•ng `new FormData(e.target)`. Cu·ªëi c√πng, ch√∫ng ta g·ªçi `createUser.mutate` v·ªõi ƒë·ªëi s·ªë l√† ƒë·ªëi t∆∞·ª£ng `formData` ƒë√£ ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi th√†nh m·ªôt ƒë·ªëi t∆∞·ª£ng JavaScript th√¥ng qua `Object.fromEntries(formData)`.

4. Trong ph·∫ßn render, ch√∫ng ta hi·ªÉn th·ªã m·ªôt form v·ªõi hai tr∆∞·ªùng nh·∫≠p d·ªØ li·ªáu (name v√† email) v√† m·ªôt n√∫t "Create User" ƒë·ªÉ g·ª≠i y√™u c·∫ßu t·∫°o m·ªõi ng∆∞·ªùi d√πng. N√∫t "Create User" s·∫Ω b·ªã v√¥ hi·ªáu h√≥a (`disabled`) khi mutation ƒëang ti·∫øn h√†nh (d·ª±a tr√™n `createUser.isLoading`). VƒÉn b·∫£n c·ªßa n√∫t c≈©ng thay ƒë·ªïi t√πy thu·ªôc v√†o tr·∫°ng th√°i t·∫£i (`createUser.isLoading`).

- V·ªõi React Query, ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng `useMutation` ƒë·ªÉ d·ªÖ d√†ng th·ª±c hi·ªán c√°c thao t√°c mutation nh∆∞ t·∫°o, c·∫≠p nh·∫≠t ho·∫∑c x√≥a d·ªØ li·ªáu (POST, PUT, DELETE). React Query s·∫Ω t·ª± ƒë·ªông qu·∫£n l√Ω tr·∫°ng th√°i c·ªßa mutation v√† cung c·∫•p c√°c ph∆∞∆°ng th·ª©c v√† thu·ªôc t√≠nh ƒë·ªÉ theo d√µi v√† ƒëi·ªÅu khi·ªÉn qu√° tr√¨nh mutation.

## 3. S·ª≠ d·ª•ng `useQueryClient` ƒë·ªÉ x√≥a b·ªô nh·ªõ cache ho·∫∑c l√†m m·ªõi d·ªØ li·ªáu:

```jsx
import { useQueryClient } from 'react-query'

function ProfilePage({ userId }) {
  const queryClient = useQueryClient()

  const handleLogout = () => {
    // X√≥a b·ªô nh·ªõ cache c·ªßa t·∫•t c·∫£ c√°c truy v·∫•n
    queryClient.clear()

    // L√†m m·ªõi d·ªØ li·ªáu truy v·∫•n "userData"
    queryClient.invalidateQueries('userData')
  }

  return (
    <div>
      <h2>Welcome, User!</h2>
      <button onClick={handleLogout}>Logout</button>
    </div>
  )
}
```

‚ùì Gi·∫£i th√≠ch code chi ti·∫øt:

- ƒêo·∫°n code tr√™n l√† m·ªôt v√≠ d·ª• v·ªÅ vi·ªác s·ª≠ d·ª•ng `useQueryClient` t·ª´ React Query ƒë·ªÉ qu·∫£n l√Ω b·ªô nh·ªõ cache v√† th·ª±c hi·ªán c√°c t√°c v·ª• li√™n quan ƒë·∫øn qu·∫£n l√Ω cache v√† truy v·∫•n.

- D∆∞·ªõi ƒë√¢y l√† c√°ch ho·∫°t ƒë·ªông c·ªßa code:

1. S·ª≠ d·ª•ng hook `useQueryClient` t·ª´ React Query ƒë·ªÉ nh·∫≠n m·ªôt instance c·ªßa `queryClient`, ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ qu·∫£n l√Ω b·ªô nh·ªõ cache v√† th·ª±c hi·ªán c√°c thao t√°c li√™n quan ƒë·∫øn cache v√† truy v·∫•n.

2. Trong h√†m `handleLogout`, ch√∫ng ta th·ª±c hi·ªán hai t√°c v·ª•:

- `queryClient.clear()`: X√≥a b·ªô nh·ªõ cache c·ªßa t·∫•t c·∫£ c√°c truy v·∫•n. Ph∆∞∆°ng th·ª©c n√†y s·∫Ω x√≥a h·∫øt t·∫•t c·∫£ c√°c truy v·∫•n ƒë√£ ƒë∆∞·ª£c l∆∞u tr·ªØ trong cache, ƒë·∫£m b·∫£o r·∫±ng d·ªØ li·ªáu cache ƒë∆∞·ª£c l√†m m·ªõi ho√†n to√†n.
- `queryClient.invalidateQueries('userData')`: L√†m m·ªõi d·ªØ li·ªáu cho truy v·∫•n c√≥ key l√† `'userData'`. Ph∆∞∆°ng th·ª©c n√†y s·∫Ω x√≥a cache c·ªßa truy v·∫•n `'userData'`, ƒë·ªìng th·ªùi k√≠ch ho·∫°t m·ªôt truy v·∫•n m·ªõi ƒë·ªÉ l·∫•y d·ªØ li·ªáu m·ªõi nh·∫•t t·ª´ ngu·ªìn d·ªØ li·ªáu. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng sau khi ƒëƒÉng xu·∫•t, khi ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p l·∫°i, d·ªØ li·ªáu ng∆∞·ªùi d√πng m·ªõi nh·∫•t s·∫Ω ƒë∆∞·ª£c t·∫£i l·∫°i t·ª´ API.

3. Trong ph·∫ßn render, ch√∫ng ta hi·ªÉn th·ªã m·ªôt ti√™u ƒë·ªÅ ch√†o m·ª´ng ng∆∞·ªùi d√πng v√† m·ªôt n√∫t `"Logout"` ƒë·ªÉ th·ª±c hi·ªán ƒëƒÉng xu·∫•t. Khi ng∆∞·ªùi d√πng nh·∫•p v√†o n√∫t `"Logout"`, h√†m `handleLogout` s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x√≥a cache v√† l√†m m·ªõi d·ªØ li·ªáu truy v·∫•n `'userData'`.

- V·ªõi React Query, ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng `useQueryClient` ƒë·ªÉ truy c·∫≠p v√† qu·∫£n l√Ω b·ªô nh·ªõ cache. Ch√∫ng ta c√≥ th·ªÉ x√≥a cache c·ªßa c√°c truy v·∫•n c·ª• th·ªÉ, l√†m m·ªõi d·ªØ li·ªáu t·ª´ ngu·ªìn d·ªØ li·ªáu v√† th·ª±c hi·ªán c√°c t√°c v·ª• qu·∫£n l√Ω cache kh√°c.

- ‚úÖ Tr√™n ƒë√¢y l√† 3 v√≠ d·ª• c∆° b·∫£n ƒë·ªÉ minh h·ªça vi·ªác s·ª≠ d·ª•ng React Query. C√≥ r·∫•t nhi·ªÅu t√≠nh nƒÉng v√† kh·∫£ nƒÉng trong React Query ƒë·ªÉ kh√°m ph√° v√† t√πy ch·ªânh theo nhu c·∫ßu c·ªßa d·ª± √°n.

---

## Cho c√°c v√≠ d·ª• v·ªÅ React Query n√¢ng cao ?

---

## Cho c√°c v√≠ d·ª• v·ªÅ React Query trong th·ª±c t·∫ø ?

---

## React query c√≥ thay th·∫ø redux kh√¥ng ?

---

## Trong c√°c d·ª± √°n th√¨ c√¥ng ngh·ªá React Query c√≥ ƒë∆∞·ª£c s·ª≠ d·ª•ng nhi·ªÅu kh√¥ng ?

---

## ƒê√¢y l√† Docs c·ªßa ƒê∆∞·ª£c Dev:

Cu·ªëi c√πng th√¨ ch√∫ng ta c≈©ng ƒë√£ ƒëi ƒë·∫øn video cu·ªëi c√πng trong series n√†y, trong video n√†y th√¨ m√¨nh s·∫Ω h∆∞·ªõng d·∫´n c√°c b·∫°n nh·ªØng ki·∫øn th·ª©c cu·ªëi c√πng trong React Query. Yay üòÅ, hy v·ªçng qua series n√†y c√°c b·∫°n ƒë√£ h·ªçc ƒë∆∞·ª£c nhi·ªÅu ƒëi·ªÅu th√∫ v·ªã.

üíìKi·∫øn th·ª©c c√°c b·∫°n s·∫Ω ƒë∆∞·ª£c h·ªçc trong video n√†y:

üéâ Hi·ªÉu r√µ h∆°n c√°ch ho·∫°t ƒë·ªông c·ªßa fetching v·ªõi staleTime
üéâ T·∫°o spinner loading global d·ª±a tr√™n query v√† mutation
üéâ Bi·∫øt ƒë∆∞·ª£c c√°ch d√πng AbortController
üéâ Cancel Request trong React Query

üï∞Ô∏èN·ªôi dung ch√≠nh

```bash
00:00 - √în t·∫≠p l·∫°i staleTime
07:46 - Fetching Indicators
14:06 - Query Cancellation
```
